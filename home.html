<!DOCTYPE html>
<html lang="en">
<!--Common Taglib-->
<?!= include("taglib"); ?>
<?!= include("style-css"); ?>
<?!= include("page-js"); ?>

  <body class="sb-nav-fixed">
    
    
      <div id="layoutSidenav" >
      
<?!= include("header"); ?>
        <div id="layoutSidenav_nav">
            <nav class="sb-sidenav accordion sb-sidenav-light" id="sidenavAccordion" >
            
                <?!= include("nav"); ?><!--Navigation bar-->
                <div class="sb-sidenav-footer" style="background-color:#def3fd">
                    <div class="small">Logged in as:</div>
                    <span class="medium"><?= user; ?></span>
                </div>
            </nav>
        </div>
        

        <div id="layoutSidenav_content">
          <main>
            <div class="pimg1">
              <div class="ptext">
                <span class="border">Welcome!</span>
              </div>
            </div>
            

<!---------------HOME------------------------------------->


            <section class="section section-light" id="home" style="background-color:#ffce8b">
            <!---------------------------------------------------------->            
            
<h1 class="p-5" style="  top:50%;
  width:100%;
  text-align:center;
  color:#000;
  font-size:27px;
  letter-spacing:8px;
  text-transform:uppercase;
  font-size:bold;"> NEWS & UPDATE </h1>
              <div class="row">
                            
              <!---------------------1ST CARD (ANIMATED) - VOUCHER CODE------------------------------->  

                <div class="col-xl-7">
                    <div class="card" height="100vh">
                    <h3 style="text-align: left">VIC COVID Update</h3>
                      <ul style="text-align: left">
                          <li>Melbourne in curfew hour: starting from 8pm every day for at least 6 weeks</li>
                          <li>Facial covers are mandatory for couriers in VIC</li>

                      </ul>
                      <h3 style="text-align: left">QA Incentives </h3>
                      <h3 style="text-align: left">MDS McD's shouldn't be debited for any order issues </h3>
                    </div>
                      
                  </div>
             <!--------------------2ND CARD - NEWS-------------------------------->  
  
                  <div class="col-xl-5">
                        <div class="card-container" id="card-container">
                          <div class="card mb-4">
                              <h1>Top Performers</h1>
                            <ul>
                                <li>Jaspreet Kaur</li>
                                <li>Gurstinder Singh</li>
                                <li>Kiya Morris</li>
                                <li>Inderjeet Singh</li>
                            </ul>
                          </div>
                          <div class="card-voucher green">
                            <div class="additional">
                              <div class="more-info" >
                                <img id='QRcode' src="<?= QRurl ?>" width="125px" height="125px" />
                                <h1 style="text-transform: uppercase;"><?= voucher ?></h1> 
                              </div>
                            </div>
                            <div class="general"style="top:65%">
                              <h1 style="text-align: left;">VOUCHER CODE</h1>
                            </div>
                          </div>
                        </div>
                  </div>

              </div>
             
          <!----------------END 2nd------------------------------------>    
        </section>
        <div class="container-fluid p-5">
        
        
<!---------------TICKET TRACKER------------------------------------->      

        <section class="section section-light" id="ticket">
<div class="pimg2 "style="background-color:#edfaf0">
            <div class="ptext">
            <span class="border">Ticket Tracker</span>
            </div>
            </div>
          <div class="row mt-5 mb-5">
            <div class="card mb-4 col-xl-5">
                <div class="card-header"><i class="fas fa-table mr-1"></i>DataTable Example</div>
                <div class="card-body">
                    <div class="table-responsive" style="font-size:12px">
                        <table class="table table-bordered" id="ticketTable" width="100%" cellspacing="0" >
                            <thead>
                                <tr>
                                    <th>Timestamp</th>
                                    <th>Ticket number</th>
                                    <th class="no-sort">
                                      <button id="btnDelete" type="button"
												onclick="warningBeforeDelete()"
												class="dt-button buttons-html5 btn btn-white btn-primary btn-bold rounded-lg"
												data-toggle="tooltip" title='Delete'>
												<i class="far fa-trash-alt"></i>
                                    </button></th>
                                </tr>
                            </thead>
                            
                            <tbody id="ticketBody">
                                <? for (var i=0;i<ticDat.length;i++){ ?>
                                  <tr>
                                    <td class="date"><?= ticDat[i][0]?></td>
                                    <td class="ticNum"><?= ticDat[i][1]?></td>
                                    <td>
                                      <div class="form-group">
                                        <div class="custom-control custom-checkbox">
                                        <input class="custom-control-input" id="<?= ticDat[i][1]?>" type="checkbox" />
                                        <label class="custom-control-label" for="<?= ticDat[i][1]?>"></label>
                                        </div>
                                      </div>
                                    </td>
                                  </tr>
                                        
                                <? } ?>
                                
                            </tbody>
                        </table>

                    </div>
                    <div class="row">
                        <div class="col-xl-8"><input class="form-control py-4" id="inputTicket" type="number" placeholder="Enter ticket number" /></div>
                        <button class="btn btn-primary" id="submitTicket" style="margin: auto;">Done</button>
                    </div>
                    
                </div>
              </div> 
               <div class="card mb-4 col-xl-7">
                <div class="card mb-4">
                    <div class="card-header"><i class="fas fa-chart-area mr-1"></i>Tickets Timeline</div>
                    <div class="card-body"><canvas id="timelineTicChart" width="100%" height="27"></canvas></div>
                </div>
                <div class="card mb-4">
                    <div class="card-header"><i class="fas fa-chart-area mr-1"></i>Top Solvers</div>
                    <div class="card-body"><canvas id="topTicChart" width="100%" height="27"></canvas></div>
                </div>
               </div> 
            </div>
           
        </section>
<!---------------QA------------------------------------->
            
        <section id="qa" >
            <div class="pimg3"style="background-color:#ffce8b">
              <div class="ptext">
                <span class="border">QA Scorecard</span>
              </div>
            </div>

              <div class="card" style="border:none">
                <div class="card-body" >
                  <div class="table-responsive">
                    <table class="table table-bordered" id="callTab" cellspacing="0">
                    
                      <thead>
                        <tr>
                          <th>Record Date</th>
                          <th>Ticket number</th>
                          <th>Type</th>
                          <th>Score</th>
                          <th>Comments</th>
                        </tr>
                      </thead>
                    
                      <tbody>
                        <?!= score ?>
                      </tbody>
                      
                    </table>
                  </div>
                </div>
              </div>
            

                    </section>

<!---------------MONTHLy REPORT------------------------------------->

                    <section id="report" >
                    <div class="pimg4" style="background-color:#edfaf0">
              <div class="ptext">
              <span class="border">Monthly Report</span>
              </div>
            </div>
                        <div class="row">
                            <div class="card mb-4 col-xl-6">
                                <div class="card mb-4">
                                    <div class="card-header"><i class="fas fa-chart-area mr-1"></i>Attendance</div>
                                    <div class="card-body"><canvas id="AttendanceChart" width="100%" height="30"></canvas></div>
                                </div>
                                <div class="card mb-4">
                                    <div class="card-header"><i class="fas fa-chart-area mr-1"></i>QA</div>
                                    <div class="card-body"><canvas id="QAChart" width="100%" height="30"></canvas></div>
                                </div>
                            </div>
                            <div class="card mb-4 col-xl-6">
                                <div class="card mb-4">
                                    <div class="card-header"><i class="fas fa-chart-area mr-1"></i>CSAT</div>
                                    <div class="card-body"><canvas id="CSATChart" width="100%" height="30"></canvas></div>
                                </div>
                                <div class="card mb-4">
                                    <div class="card-header"><i class="fas fa-chart-area mr-1"></i>Ticket</div>
                                    <div class="card-body"><canvas id="TicketChart" width="100%" height="30"></canvas></div>
                                </div>
                            </div>
                        </div>

                    </section>
<!---------------Ml LINKS------------------------------------->

                    <section id="mlLink">
                    <div class="pimg5">
              <div class="ptext">
              <span class="border trans">ML Link</span>
              </div>
            </div>
                    <div class="limit-items">
                        <input type='checkbox' id='show-all'>
                        <label for='show-all' class='text-show'>Show</label>
                        <label for='show-all' class='text-hide'>Hide</label>
                          <div class="items">
                            <div class="row">
                              <div class="col-xl-4">
                                      <h2><?= links.tool[0][0] ?></h2>
                                        <? for (var i=1;i<links.tool.length;i++){ ?>
                                            <a class="nav-link" href="<?= links.tool[i][1]?>"><?= links.tool[i][0] ?></a>
                                        <? } ?>
                             </div>
                             <div class="col-xl-4">
                                      <h2><?= links.site[0][0] ?></h2>
                                      <? for (var i=1;i<links.site.length;i++){ ?>
                                          <a class="nav-link" href="<?= links.site[i][1]?>"><?= links.site[i][0] ?></a>
                                      <? } ?>
                             </div>
                             <div class="col-xl-4">
                                      <h2><?= links.guide[0][0] ?></h2>
                                      <? for (var i=1;i<links.guide.length;i++){ ?>
                                          <a class="nav-link" href="<?= links.guide[i][1]?>"><?= links.guide[i][0] ?></a>
                                      <? } ?>
                             </div>
                           </div>
                         </div>

                    </div>

                    </section>
                    
            
           </div>

        </main>
        <?!= include("footer"); ?>
        </div>
      </div>
    
  </body>
  
<script> //TOGGLE BUTTON
  (function($) {
  "use strict";
  
  // Add active state to sidbar nav links
  var path = window.location.href; // because the 'href' property of the DOM element is the absolute path
  $("#layoutSidenav_nav .sb-sidenav a.nav-link").each(function() {
  if (this.href === path) {
  $(this).addClass("active");
  }
  });
  
  // Toggle the side navigation
  $("#sidebarToggle").on("click", function(e) {
  e.preventDefault();
  $("body").toggleClass("sb-sidenav-toggled");
  });
  })(jQuery);
</script>

<script>//VOUCHER CARD REVEAL
  document.getElementById("card-container").addEventListener("mouseleave",function(){
  document.getElementById("change").checked=false;
  })
  
  	var scroll = new SmoothScroll('a[href*="#"]', {
	speed: 1500,
	speedAsDuration: true
});
</script>

<script> //DATA TABLE
//Ticket table

   $(document).ready(function() {
   
    var date=new Date;
    var t = $('#ticketTable').DataTable({
        "order": [],
        "columnDefs": [ {
        "targets"  : 'no-sort',
        "orderable": false
        }],
    "paging": false,
    "scrollY": 300,

    });


    //Add ticket

    $('#submitTicket').on( 'click', function () {

        if($('#inputTicket').val()!=""){
             t.row.add( [
              date.toLocaleDateString(),
              $('#inputTicket').val(),
              "<td><div class='form-group'><div class='custom-control custom-checkbox'><input class='custom-control-input' type='checkbox' name='delete' id='"
              +$('#inputTicket').val()
              +"'/><label class='custom-control-label' for='"
              +$('#inputTicket').val()
              +"'></label></div></div></td>"
          ] ).draw( false );
          google.script.run.addTic(date.toLocaleDateString(),document.getElementById("inputTicket").value,<?= user; ?>);
          $('#inputTicket').val("");
           $('#topTicChart').update();}
    });
    
    //Delete ticket
    $('#btnDelete').on( 'click', function () {
    
    var notChecked = [], checked = [];
    $(":checkbox").map(function() {
        if(this.checked){
          checked.push(this.id)
          t.row($(this).parents('tr')).remove().draw(false);
        }else{ notChecked.push(this.id);}
    });
    
    google.script.run.deleteR(checked,<?= user; ?>)
    });

//QA table
    $.fn.dataTable.moment( 'MMM Do' );
    
   var callTab = $('#callTab').DataTable({
        "columnDefs":[
        {"targets":0,
          "render":function(data){
         return moment(data).format('MMM Do');}
         },
         {"targets":3,
          "render": function ( data) {
           return +Number.parseFloat(data*100).toFixed(3)+'%';}
          }],
    "paging": false,
    "scrollY": 400,
    "order": [[ 0, "desc" ]],
    "autoWidth": false
    });

  });
  

             

</script>

<script> //TICKET CHART
// Set new default font family and font color to mimic Bootstrap's default styling
Chart.defaults.global.defaultFontFamily = '-apple-system,system-ui,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif';
Chart.defaults.global.defaultFontColor = '#292b2c';

// Bar Chart Example
var ctx = document.getElementById("topTicChart");
var xlabel=[];
<? for (var i=0;i<ticGraph.top[0].length;i++){ ?>
xlabel.push(<?=ticGraph.top[0][i];?>)
<? } ?>
var topTic =[];
<? for (var i=0;i<ticGraph.top[1].length;i++){ ?>
topTic.push(<?=ticGraph.top[1][i];?>)
<? } ?>

var myLineChart = new Chart(ctx, {
  type: 'bar',
  data: {
    labels: xlabel,
    datasets: [{
      label: "Ticket Solved",
      backgroundColor: "rgba(2,117,216,1)",
      borderColor: "rgba(2,117,216,1)",
      data: topTic,
    }],
  },
  options: {
    scales: {
      xAxes: [{
        time: {
          unit: 'month'
        },
        gridLines: {
          display: false
        },
        ticks: {
          maxTicksLimit: 6
        }
      }],
      yAxes: [{
        ticks: {
          min: 0,
          maxTicksLimit: 5
        },
        gridLines: {
          display: true
        }
      }],
    },
    legend: {
      display: false
    }
  }
});

// TIMELINE TICCHART
var date=[];
<? for (var i=1;i<ticGraph.timeline[0].length;i++){ ?>
date.push(<?=ticGraph.timeline[0][i];?>)
<? } ?>
var tic =[];
<? for (var i=1;i<ticGraph.timeline[1].length;i++){ ?>
tic.push(<?=ticGraph.timeline[1][i];?>)
<? } ?>
var ctx1 = document.getElementById("timelineTicChart");
var myLineChart = new Chart(ctx1, {
  type: 'line',
  data: {
    labels: date,
    datasets: [{
      label: "Sessions",
      lineTension: 0.3,
      backgroundColor: "rgba(2,117,216,0.2)",
      borderColor: "rgba(2,117,216,1)",
      pointRadius: 5,
      pointBackgroundColor: "rgba(2,117,216,1)",
      pointBorderColor: "rgba(255,255,255,0.8)",
      pointHoverRadius: 5,
      pointHoverBackgroundColor: "rgba(2,117,216,1)",
      pointHitRadius: 50,
      pointBorderWidth: 2,
      data:tic,
    }],
  },
  options: {
    scales: {
      xAxes: [{
        time: {
          unit: 'date'
        },
        gridLines: {
          display: false
        },
        ticks: {
          maxTicksLimit: 7
        }
      }],
      yAxes: [{
        ticks: {
          maxTicksLimit: 5
        },
        gridLines: {
          color: "rgba(0, 0, 0, .125)",
        }
      }],
    },
    legend: {
      display: false
    }
  }
});
</script>	

<script>//MONTHLY CHART

// Set new default font family and font color to mimic Bootstrap's default styling
Chart.defaults.global.defaultFontFamily = '-apple-system,system-ui,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif';
Chart.defaults.global.defaultFontColor = '#292b2c';

//ATTENDANCE CHART
var attendance =[];
<? for (var i=0;i<report.attendance.length;i++){ ?>
attendance.push(<?=report.attendance[i]*100.00;?>)
<? } ?>
var ctx2 = document.getElementById("AttendanceChart");
var AttendanceChart = new Chart(ctx2, {
  type: 'line',
  data: {
    labels: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
    datasets: [{
      lineTension: 0.3,
      backgroundColor: "rgba(2,117,216,0.2)",
      borderColor: "rgba(2,117,216,1)",
      pointRadius: 5,
      pointBackgroundColor: "rgba(2,117,216,1)",
      pointBorderColor: "rgba(255,255,255,0.8)",
      pointHoverRadius: 5,
      pointHoverBackgroundColor: "rgba(2,117,216,1)",
      pointHitRadius: 50,
      pointBorderWidth: 2,
      data:attendance,
    }],
  },
  options: {
    scales: {
      xAxes: [{
        time: {
          unit: 'month'
        },
        gridLines: {
          display: false
        }
      }],
      yAxes: [
    {
      ticks: {
        min: 0
      },
      scaleLabel: {
        display: true,
        labelString: 'Percentage',
      },
              gridLines: {
          color: "rgba(0, 0, 0, .125)",
        }
    },
  ],

    },
    legend: {
      display: false
    }
  }
});

//TICKET CHART
var touches =[];
<? for (var i=0;i<report.ticket[0].length;i++){ ?>
touches.push(<?=report.ticket[0][i];?>)
<? } ?>
var solved =[];
<? for (var i=0;i<report.ticket[1].length;i++){ ?>
solved.push(<?=report.ticket[1][i];?>)
<? } ?>

var ctx3 = document.getElementById("TicketChart");
var ticketChart = new Chart(ctx3, {
  type: 'line',
  data: {
    labels: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
    datasets: [{
      label:"Touches",
      lineTension: 0.3,
      backgroundColor: "rgba(2,117,216,0.2)",
      borderColor: "rgba(2,117,216,1)",
      pointRadius: 5,
      pointBackgroundColor: "rgba(2,117,216,1)",
      pointBorderColor: "rgba(255,255,255,0.8)",
      pointHoverRadius: 5,
      pointHoverBackgroundColor: "rgba(2,117,216,1)",
      pointHitRadius: 50,
      pointBorderWidth: 2,
      data:touches,
    },
    {
      label:"Solved",
      lineTension: 0.3,
      backgroundColor: "rgba(2,117,216,0.2)",
      borderColor: "rgba(2,117,216,1)",
      pointRadius: 5,
      pointBackgroundColor: "rgba(2,117,216,1)",
      pointBorderColor: "rgba(255,255,255,0.8)",
      pointHoverRadius: 5,
      pointHoverBackgroundColor: "rgba(2,117,216,1)",
      pointHitRadius: 50,
      pointBorderWidth: 2,
      data:solved,
    }],
  },
  options: {
    scales: {
      xAxes: [{
        time: {
          unit: 'month'
        },
        gridLines: {
          display: false
        }
      }],
      yAxes: [
    {
      ticks: {
        min: 0
      },
      scaleLabel: {
        display: true,
        labelString: 'Amount',
      },
              gridLines: {
          color: "rgba(0, 0, 0, .125)",
        }
    },
  ],

    },
    legend: {
      display: false
    }
  }
});

//QA CHART
var voice =[];
<? for (var i=0;i<report.qa[0].length;i++){ ?>
voice.push(<?=report.qa[0][i]*100.00;?>)
<? } ?>
var chat =[];
<? for (var i=0;i<report.qa[1].length;i++){ ?>
chat.push(<?=report.qa[1][i]*100.00;?>)
<? } ?>
var email =[];
<? for (var i=0;i<report.qa[2].length;i++){ ?>
email.push(<?=report.qa[2][i]*100.00;?>)
<? } ?>

var ctx4 = document.getElementById("QAChart");
var AttendanceChart = new Chart(ctx4, {
  type: 'bar',
  data: {
    labels: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
    datasets: [{
      label:"Voice",
      lineTension: 0.3,
      backgroundColor: "rgba(2,117,216,1)",
      borderColor: "rgba(2,117,216,1)",
      data:voice,
    },
    {
      label:"Chat",
      backgroundColor: "rgba(2,117,216,1)",
      borderColor: "rgba(2,117,216,1)",
      data:chat,
    },
    {
      label:"Email",
      backgroundColor: "rgba(2,117,216,1)",
      borderColor: "rgba(2,117,216,1)",
      data:email,
    }],
  },
  options: {
    scales: {
      xAxes: [{
        time: {
          unit: 'month'
        },
        gridLines: {
          display: false
        }
      }],
      yAxes: [
    {
      ticks: {
        min: 0
      },
      scaleLabel: {
        display: true,
        labelString: 'Percentage',
      },
              gridLines: {
          color: "rgba(0, 0, 0, .125)",
        }
    },
  ],

    },
    legend: {
      display: false
    }
  }
});

//CSAT CHART
var csatV =[];
<? for (var i=0;i<report.csat[0].length;i++){ ?>
csatV.push(<?=report.csat[0][i]*100.00;?>)
<? } ?>
var csatC=[];
<? for (var i=0;i<report.csat[1].length;i++){ ?>
csatC.push(<?=report.csat[1][i]*100.00;?>)
<? } ?>

var ctx5 = document.getElementById("CSATChart");
var AttendanceChart = new Chart(ctx5, {
  type: 'line',
  data: {
    labels: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
    datasets: [{
      label:"Voice",
      lineTension: 0.3,
      backgroundColor: "rgba(2,117,216,0.2)",
      borderColor: "rgba(2,117,216,1)",
      pointRadius: 5,
      pointBackgroundColor: "rgba(2,117,216,1)",
      pointBorderColor: "rgba(255,255,255,0.8)",
      pointHoverRadius: 5,
      pointHoverBackgroundColor: "rgba(2,117,216,1)",
      pointHitRadius: 50,
      pointBorderWidth: 2,
      data:csatV,
    },
    {
      label:"Chat",
      lineTension: 0.3,
      backgroundColor: "rgba(2,117,216,0.2)",
      borderColor: "rgba(2,117,216,1)",
      pointRadius: 5,
      pointBackgroundColor: "rgba(2,117,216,1)",
      pointBorderColor: "rgba(255,255,255,0.8)",
      pointHoverRadius: 5,
      pointHoverBackgroundColor: "rgba(2,117,216,1)",
      pointHitRadius: 50,
      pointBorderWidth: 2,
      data:csatC,
    }],
  },
  options: {
    scales: {
      xAxes: [{
        time: {
          unit: 'month'
        },
        gridLines: {
          display: false
        }
      }],
      yAxes: [
    {
      ticks: {
        min: 0
      },
      scaleLabel: {
        display: true,
        labelString: 'Percentage',
      },
              gridLines: {
          color: "rgba(0, 0, 0, .125)",
        }
    },
  ],

    },
    legend: {
      display: false
    }
  }
});
</script>
</html>